{'Create a view called pricing_summary_report for the following query: the Pricing Summary Report Query provides a summary pricing report for all lineitems shipped as of a given date. The date is within 90 days of the greatest ship date contained in the database (which is 1998-12-01). The query lists totals for extended price, discounted extended price, discounted extended price plus tax, average quantity, average extended price, and average discount. These aggregates are grouped by RETURNFLAG and LINESTATUS, and listed in ascending order of RETURNFLAG and LINESTATUS. A count of the number of lineitems in each group is included.\n': 'CREATE VIEW q1view as SELECT\n"RETURNFLAG",\n"LINESTATUS",\nSUM("QUANTITY") AS SUM_QTY,\nSUM("EXTENDEDPRICE") AS SUM_BASE_PRICE, SUM("EXTENDEDPRICE"*(1-"DISCOUNT")) AS SUM_DISC_PRICE, SUM("EXTENDEDPRICE"*(1-"DISCOUNT")*(1+"TAX")) AS SUM_CHARGE, AVG("QUANTITY") AS AVG_QTY,\nAVG("EXTENDEDPRICE") AS AVG_PRICE,\nAVG("DISCOUNT") AS AVG_DISC,\nCOUNT(*) AS COUNT_ORDER\nFROM\nLINEITEM\nWHERE\n"SHIPDATE" <= date\'1998-12-01\' - INTERVAL\'[90]\'DAY\nGROUP BY "RETURNFLAG",\n"LINESTATUS" ORDER BY\n"RETURNFLAG", "LINESTATUS";\n\n\n', "Create a view minimum_cost_supplier for the following query: the Minimum Cost Supplier Query finds, in the region EUROPE, for each part of type BRASS and size 15, the supplier who can supply it at minimum cost. If several suppliers in that region offer the desired part type and size at the same (minimum) cost, the query lists the parts from suppliers with the 100 highest account balances. For each supplier, the query lists the supplier's account balance, name and nation; the part's number and manufacturer; the supplier's address, phone number and comment information.\n": 'CREATE VIEW q2view as select\nSUPPLIER."ACCTBAL",\nSUPPLIER."NAME" as supplier_name, NATION."NAME" as nation_name, PART."PARTKEY", PART."MFGR", SUPPLIER."ADDRESS", SUPPLIER."PHONE", SUPPLIER."COMMENT"\nfrom\npart,\nsupplier, partsupp, nation, region\nwhere\nPART."PARTKEY" = PARTSUPP."PARTKEY"\nand SUPPLIER."SUPPKEY" = PARTSUPP."SUPPKEY" and PART."SIZE" = 15\nand PART."TYPE" like \'%BRASS\'\nand SUPPLIER."NATIONKEY" = NATION."NATIONKEY" and NATION."REGIONKEY" = REGION."REGIONKEY" and REGION."NAME" = \'EUROPE\'\nand PARTSUPP."SUPPLYCOST" = ( select\n\t\t\t\t\t min(PARTSUPP."SUPPLYCOST") from\n\t\t\t\t\tpartsupp, supplier,\n\t\t\t\t\tnation, region where\n\t\t\t\t\tPART."PARTKEY" = PARTSUPP."PARTKEY"\n\t\t\t\t\tand SUPPLIER."SUPPKEY" = PARTSUPP."SUPPKEY" and SUPPLIER."NATIONKEY" = NATION."NATIONKEY" and NATION."REGIONKEY" = REGION."REGIONKEY" and REGION."NAME" = \'EUROPE\')\norder by\nSUPPLIER."ACCTBAL" desc, NATION."NAME", SUPPLIER."NAME", PART."PARTKEY" limit 100;\n', 'The Shipping Priority Query retrieves the shipping priority and potential revenue, defined as the sum of extendedprice * (1-discount), of the orders having the largest revenue among those that had not been shipped as of 1995-03-15. Only consider orders made by customers in the BUILDING market segment. Orders are listed in decreasing order of revenue. If more than 10 unshipped orders exist, only the 10 orders with the largest revenue are listed.\n': 'CREATE VIEW q3view as SELECT\nLINEITEM."ORDERKEY",\nSUM(LINEITEM."EXTENDEDPRICE"*(1-LINEITEM."DISCOUNT")) AS REVENUE, ORDERS."ORDERDATE",\nORDERS."SHIPPRIORITY"\nFROM\nCUSTOMER,\nORDERS,\nLINEITEM WHERE\nCUSTOMER."MKTSEGMENT" = \'BUILDING\' AND CUSTOMER."CUSTKEY" = ORDERS."CUSTKEY"\nAND ORDERS."ORDERKEY" = LINEITEM."ORDERKEY" AND ORDERS."ORDERDATE" < DATE \'1995-03-15\' AND LINEITEM."SHIPDATE" > DATE \'1995-03-15\'\nGROUP BY LINEITEM."ORDERKEY",\nORDERS."ORDERDATE",\nORDERS."SHIPPRIORITY" ORDER BY\nREVENUE DESC, ORDERS."ORDERDATE" limit 10;\n', 'The Order Priority Checking Query counts the number of orders ordered in the last quarter of 1993 (between 1993-07-01 and 3 months after that) in which at least one lineitem was received by the customer later than its committed date. The query lists the count of such orders for each order priority sorted in ascending priority order.\n': 'CREATE VIEW q4view as select\nORDERS."ORDERPRIORITY",\ncount(*) as order_count from\norders where\nORDERS."ORDERDATE" >= date \'1993-07-01\'\nand ORDERS."ORDERDATE" < date \'1993-07-01\' + interval \'3\' month and exists (\n\tselect\n\t\t*\n\t\tfrom\n\t\tlineitem\n\t\twhere\n\t\tLINEITEM."ORDERKEY" = ORDERS."ORDERKEY"\n\t\tand LINEITEM."COMMITDATE" < LINEITEM."RECEIPTDATE"\n) group by\nORDERS."ORDERPRIORITY" order by\nORDERS."ORDERPRIORITY";', "The Returned Item Reporting Query finds the top 20 customers, in terms of their effect on lost revenue for the 3-month quarter starting on 1993-10-01, who have returned parts. The query considers only parts that were ordered in the specified quarter. The query lists the customer's name, address, nation, phone number, account balance, comment information and revenue lost. The customers are listed in descending order of lost revenue. Revenue lost is defined as sum(extendedprice*(1-discount)) for all qualifying lineitems.\n": 'CREATE VIEW q10view as select\nCUSTOMER."CUSTKEY",\nCUSTOMER."NAME" as customer_name,\nsum(LINEITEM."EXTENDEDPRICE" * (1 - LINEITEM."DISCOUNT")) as revenue, CUSTOMER."ACCTBAL",\nNATION."NAME" as nation_name,\nCUSTOMER."ADDRESS",\nCUSTOMER."PHONE",\nCUSTOMER."COMMENT"\nfrom\ncustomer,\norders, lineitem, nation\nwhere\nCUSTOMER."CUSTKEY" = ORDERS."CUSTKEY"\nand LINEITEM."ORDERKEY" = ORDERS."ORDERKEY"\nand ORDERS."ORDERDATE" >= date \'1993-10-01\'\nand ORDERS."ORDERDATE" < date \'1993-10-01\' + interval \'3\' month and LINEITEM."RETURNFLAG" = \'R\'\nand CUSTOMER."NATIONKEY" = NATION."NATIONKEY"\ngroup by CUSTOMER."CUSTKEY",\nCUSTOMER."NAME", CUSTOMER."ACCTBAL", CUSTOMER."PHONE", NATION."NAME", CUSTOMER."ADDRESS", CUSTOMER."COMMENT"\norder by\nrevenue desc limit 20;'}
